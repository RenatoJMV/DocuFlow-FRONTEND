<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comentarios y Tareas - DocuFlow</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../shared/styles/styles.css">
  <link rel="stylesheet" href="comments.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body class="modern-body">
  <!-- Navbar será generado por JavaScript -->
  <div id="navbar-container" class="container-fluid mt-4 mb-4"></div>

  <div class="comments-container">
    <!-- Header Section -->
    <div class="card-modern comments-header">
      <div class="d-flex align-items-center justify-content-between flex-wrap">
        <div class="d-flex align-items-center gap-3">
          <div class="header-icon">
            <i class="bi bi-chat-dots-fill"></i>
          </div>
          <div>
            <h1 class="h3 mb-1 text-gray-800">Comentarios y Tareas</h1>
            <p class="mb-0 text-gray-600">Gestiona comentarios y organiza tareas del proyecto</p>
          </div>
        </div>
        <div class="comments-stats d-flex">
          <div class="stat-item text-info">
            <i class="bi bi-chat-text"></i>
            <span id="commentsCount">-</span>
            <small>Comentarios</small>
          </div>
          <div class="stat-item text-warning">
            <i class="bi bi-list-task"></i>
            <span id="tasksCount">-</span>
            <small>Tareas</small>
          </div>
          <div class="stat-item text-success">
            <i class="bi bi-check-circle"></i>
            <span id="completedCount">-</span>
            <small>Completadas</small>
          </div>
        </div>
      </div>
    </div>

  <div class="row g-4">
      <!-- Comments List Section -->
      <div class="col-lg-8">
        <div class="card-modern comments-list">
          <div class="comments-list-header d-flex align-items-center justify-content-between flex-wrap">
            <h5 class="mb-0 text-gray-800">
              <i class="bi bi-list-ul me-2"></i>Lista de Comentarios y Tareas
            </h5>
            <div class="d-flex gap-2 align-items-center">
              <div class="filter-dropdown">
                <select id="filterType" class="form-select form-select-sm">
                  <option value="all">Todos</option>
                  <option value="comments">Comentarios</option>
                  <option value="tasks">Tareas</option>
                  <option value="pending">Pendientes</option>
                  <option value="completed">Completadas</option>
                </select>
              </div>
              <div class="search-box">
                <input type="text" class="form-control form-control-sm" id="searchComments" placeholder="Buscar...">
              </div>
            </div>
          </div>

          <div class="comments-content">
            <div id="commentsSection">
              <!-- Comments will be rendered here -->
            </div>
            <div id="commentsMsg" class="empty-state d-none">
              <i class="bi bi-chat-dots display-1 text-gray-400"></i>
              <h5 class="text-gray-600 mt-3">No hay comentarios aún</h5>
              <p class="text-gray-500">Los comentarios y tareas aparecerán aquí</p>
            </div>
            
            <!-- Pagination -->
            <div class="d-flex align-items-center justify-content-between mt-4">
              <div class="pagination-info text-gray-600 small">
                Mostrando <span id="showingCount">0</span> de <span id="totalCount">0</span> elementos
              </div>
              <div id="paginationContainer"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Comment Section -->
      <div class="col-lg-4">
        <div class="card-modern add-comment-section sticky-top">
          <div class="add-comment-header">
            <h5 class="mb-0 text-gray-800">
              <i class="bi bi-plus-circle me-2"></i>Nuevo Comentario/Tarea
            </h5>
          </div>
          
          <form id="newCommentForm">
            <div class="mb-3">
              <label class="form-label text-gray-700">Tipo</label>
              <div class="comment-type-selector">
                <input type="radio" class="btn-check" name="commentType" id="typeComment" value="comment" checked>
                <label class="btn btn-outline-primary" for="typeComment">
                  <i class="bi bi-chat-text me-1"></i>Comentario
                </label>
                
                <input type="radio" class="btn-check" name="commentType" id="typeTask" value="task">
                <label class="btn btn-outline-warning" for="typeTask">
                  <i class="bi bi-list-task me-1"></i>Tarea
                </label>
              </div>
            </div>

            <div class="mb-3">
              <label for="commentContent" class="form-label text-gray-700">Contenido</label>
              <textarea id="commentContent" class="form-control" rows="4" 
                      placeholder="Escribe tu comentario o describe la tarea..." required></textarea>
            </div>

            <div class="mb-3 task-fields d-none">
              <label for="assignees" class="form-label text-gray-700">Asignados</label>
              <input type="text" id="assignees" class="form-control" 
                   placeholder="Usuarios asignados (separados por coma)">
              <small class="form-text text-gray-500">Ej: juan@email.com, maria@email.com</small>
            </div>

            <div class="mb-3 task-fields d-none">
              <label for="dueDate" class="form-label text-gray-700">Fecha límite</label>
              <input type="datetime-local" id="dueDate" class="form-control">
            </div>

            <div class="mb-3 task-fields d-none">
              <label for="priority" class="form-label text-gray-700">Prioridad</label>
              <select id="priority" class="form-select">
                <option value="low">Baja</option>
                <option value="medium" selected>Media</option>
                <option value="high">Alta</option>
                <option value="urgent">Urgente</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="documentId" class="form-label text-gray-700">ID de Documento</label>
              <input type="number" id="documentId" class="form-control" 
                   placeholder="ID del documento relacionado" required>
            </div>

            <button type="submit" class="btn-modern btn-modern-primary w-100" id="submitBtn">
              <i class="bi bi-plus-circle me-2"></i>
              <span id="submitText">Agregar Comentario</span>
            </button>
          </form>
        </div>

        <!-- Quick Actions -->
        <div class="card-modern mt-3">
          <h6 class="text-gray-700 mb-3">Acciones Rápidas</h6>
          <div class="quick-actions">
            <button class="btn-modern btn-modern-outline w-100 mb-2" id="markAllRead">
              <i class="bi bi-check2-all me-2"></i>Marcar todo como leído
            </button>
            <button class="btn-modern btn-modern-outline w-100 mb-2" id="exportComments">
              <i class="bi bi-download me-2"></i>Exportar comentarios
            </button>
            <button class="btn-modern btn-modern-outline w-100" id="refreshComments">
              <i class="bi bi-arrow-clockwise me-2"></i>Actualizar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="commentsController.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
